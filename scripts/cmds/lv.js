const axios = require('axios');
const fs = require('fs');
const path = require('path');

module.exports = {
  config: {
    name: "love",
    version: "2.3",
    author: "OpenSource Edition",
    description: {
      en: "‡¶¶‡ßÅ‡¶á‡¶ú‡¶®‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ù‡ßá ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶™‡ßÅ‡¶®, ‡¶õ‡¶¨‡¶ø ‡¶∏‡¶π, ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶è‡¶ï ‡¶ú‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Æ‡¶ú‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì‡•§"
    },
    category: "fun",
    guide: {
      en: "{pn} @User1 @User2 ‡¶Ö‡¶•‡¶¨‡¶æ {pn} @User1 ‡¶Ö‡¶•‡¶¨‡¶æ {pn} ‡¶®‡¶æ‡¶Æ1 ‡¶®‡¶æ‡¶Æ2"
    }
  },

  onStart: async function ({ message, args, event, usersData, api }) {
    const token = "6628568379|c1e620fa708a1d5696fb991c1bde5662";

    const senderID = event.senderID.toString();
    const mentions = Object.keys(event.mentions);
    let name1, name2;
    let uid1, uid2;

    if (mentions.length === 2) {
      // ‡¶¶‡ßÅ‡¶á‡¶ú‡¶® ‡¶Æ‡ßá‡¶®‡¶∂‡¶® ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¶‡ßÅ‡¶á‡¶ú‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶¨‡ßá
      uid1 = mentions[0];
      uid2 = mentions[1];
      name1 = await usersData.getName(uid1);
      name2 = await usersData.getName(uid2);
    } else if (mentions.length === 1) {
      // ‡¶è‡¶ï‡¶ú‡¶®‡ßá ‡¶Æ‡ßá‡¶®‡¶∂‡¶® ‡¶ï‡¶∞‡¶≤‡ßá: ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶≤‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø + ‡¶Æ‡ßá‡¶®‡¶∂‡¶®‡¶ï‡ßÉ‡¶§‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
      uid1 = senderID;     // ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶≤‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞
      uid2 = mentions[0];  // ‡¶Æ‡ßá‡¶®‡¶∂‡¶®‡¶ï‡ßÉ‡¶§ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞

      name1 = await usersData.getName(uid1);
      name2 = await usersData.getName(uid2);

    } else if (args.length >= 2) {
      name1 = args[0];
      name2 = args[1];
    } else if (args.length === 1) {
      name1 = args[0];
      name2 = "‡¶§‡ßÅ‡¶Æ‡¶ø";
    } else {
      return message.reply("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡ßß ‡¶Ö‡¶•‡¶¨‡¶æ ‡ß® ‡¶ú‡¶® ‡¶Æ‡ßá‡¶®‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶¶‡ßÅ‡¶á‡¶ü‡¶ø ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶® ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∞ ‡¶ú‡¶æ‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø!");
    }

    const lovePercent = Math.floor(Math.random() * 101);
    const loveBar = "‚ñà".repeat(Math.floor(lovePercent / 10)) + "‚ñë".repeat(10 - Math.floor(lovePercent / 10));

    const messages = [
      "üíî ‡¶è‡¶á ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá ‡¶ï‡¶æ‡¶Å‡¶†‡¶æ‡¶≤ ‡¶ó‡¶æ‡¶õ‡ßá‡¶ì ‡¶Ü‡¶Æ ‡¶ß‡¶∞‡¶¨‡ßá ‡¶®‡¶æ ‡¶≠‡¶æ‡¶á!",
      "üò¨ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá‡¶∞ ‡¶ö‡ßá‡ßü‡ßá ‡¶¨‡¶∞‡¶Ç exam ‡¶ü‡¶æ‡¶á ‡¶≠‡¶æ‡¶≤‡ßã ‡¶≤‡¶æ‡¶ó‡¶§‡ßá‡¶õ‡ßá!",
      "üòÇ ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶æ ‡¶ï‡¶Æ, ‡¶ù‡¶ó‡ßú‡¶æ ‡¶¨‡ßá‡¶∂‡¶ø! ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ü‡¶æ ‡¶π‡¶æ‡¶â‡¶ú‡¶ø‡¶Ç ‡¶∏‡ßã‡¶∏‡¶æ‡¶á‡¶ü‡¶ø!",
      "üòê ‡¶è‡¶ï‡¶ü‡ßÅ‡¶ñ‡¶æ‡¶®‡¶ø ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶æ ‡¶Ü‡¶∞ ‡¶Ö‡¶®‡ßá‡¶ï‡¶ü‡¶æ misunderstanding!",
      "ü§® ‡¶è‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ, ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá drama ‡¶ï‡¶∞‡ßá!",
      "üò© ‡¶™‡ßç‡¶∞‡ßá‡¶Æ ‡¶ö‡¶≤‡¶õ‡ßá ‡¶†‡¶ø‡¶ï‡¶á, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶Ö‡¶®‡ßá‡¶ï ‡¶Ø‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá!",
      "üòë ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡¶ï‡ßá ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶∏‡¶ø‡¶® ‡¶®‡¶æ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ø‡ßÅ‡¶¶‡ßç‡¶ß ‡¶≤‡¶æ‡¶ó‡ßá!",
      "üôÇ ‡¶Ü‡¶ß‡¶æ ‡¶Ü‡¶ß‡¶æ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ... ‡¶¨‡ßã‡¶ù‡¶æ‡¶á ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá Crush ‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶Æ ‡¶¶‡ßá‡ßü ‡¶®‡¶æ!",
      "üòä Crush ‡¶∞‡¶ø‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶¶‡¶ø‡¶≤‡ßá ‡¶π‡ßÉ‡ßé‡¶™‡¶ø‡¶£‡ßç‡¶° 2x ‡¶∏‡ßç‡¶™‡¶ø‡¶°‡ßá ‡¶ö‡¶≤‡ßá!",
      "üòç ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶æ, ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶Ö‡¶≠‡¶ø‡¶Æ‡¶æ‡¶® ‚Äî ‡¶†‡¶ø‡¶ï TikTok ‡¶™‡ßç‡¶∞‡ßá‡¶Æ!",
      "üòò ‡¶Æ‡ßá‡¶∏‡ßá‡¶û‡ßç‡¶ú‡¶æ‡¶∞‡ßá 'Seen' ‡¶ï‡¶∞‡¶≤‡ßá‡¶á ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá ‡¶π‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ï!",
      "üòö ‡¶è‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá‡¶Æ‡¶®, ‡¶§‡ßá‡¶Æ‡¶®‡¶ø ‡¶ù‡¶ó‡ßú‡¶æ‡¶ì ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶´‡ßá‡¶∂‡¶®‡¶æ‡¶≤ ‡¶≠‡¶æ‡¶¨‡ßá!",
      "üòó ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶õ‡¶æ‡ßú‡¶æ ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶¶‡ßá‡ßü ‡¶®‡¶æ!",
      "üòå ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡¶ü‡¶æ ‡¶è‡¶Æ‡¶®, ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡¶ï‡ßá block ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶∞ unblock ‡¶ï‡¶∞‡ßá Sorry ‡¶¨‡¶≤‡¶æ!",
      "üíû ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶Ö‡¶´ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶á ‡¶°‡¶æ‡¶â‡¶ü ‡¶ö‡¶≤‡ßá ‡¶Ü‡¶∏‡ßá, ‡¶Ü‡¶∏‡¶≤‡ßá ‡¶ö‡¶æ‡¶∞‡ßç‡¶ú ‡¶∂‡ßá‡¶∑ ‡¶õ‡¶ø‡¶≤!",
      "üòª ‡¶∞‡¶æ‡¶§ ‡¶ú‡ßá‡¶ó‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ '‡¶ò‡ßÅ‡¶Æ‡¶æ‡¶ì ‡¶§‡ßã' ‡¶¨‡¶≤‡ßá ‡¶∏‡¶Æ‡ßü ‡¶™‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá!",
      "üíò ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ù‡ßá ‡¶è‡¶ï‡¶ü‡ßÅ TikTok ‡¶Ü‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßá‡¶∂‡¶ø ‡¶ó‡ßÅ‡¶°‡¶®‡¶æ‡¶á‡¶ü!",
      "üíï ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡¶ü‡¶æ Facebook story ‡¶¶‡¶ø‡ßü‡ßá‡¶á ‡¶ö‡¶≤‡ßá!",
      "üíù ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡ßá‡¶∞ emoji react ‡¶¶‡ßá‡¶ñ‡ßá‡¶ì ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶à‡¶∞‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßá!",
      "üòç relationship goal! ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡¶ï‡ßá ‡¶õ‡¶æ‡ßú‡¶æ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶®‡¶æ!",
      "ü´∂ ‡¶ì‡¶∞‡¶æ ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡¶ï‡ßá ‡¶õ‡¶æ‡ßú‡¶æ ‡¶ö‡¶æ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶ñ‡¶æ‡ßü ‡¶®‡¶æ!",
      "üíì ‡¶è‡¶á ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá ‡¶ù‡¶ó‡ßú‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ '‡¶™‡¶æ‡¶ó‡¶≤‡¶ø' ‡¶¨‡¶≤‡ßá‡¶á ‡¶Æ‡¶æ‡¶®‡¶æ‡ßü!",
      "üíñ ‡¶è‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ ‡¶Æ‡¶æ‡¶®‡ßá‡¶á ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶ï‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá 'My Life'!",
      "üíó ‡¶™‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßã ‡¶®‡¶æ, ‡¶Ø‡ßá‡¶® Netflix ‡¶∏‡¶ø‡¶∞‡¶ø‡¶ú ‚Äî ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßá‡¶ï‡¶¶‡¶ø‡¶® twist!",
      "üíü ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡ßá, ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶¨‡¶ø‡ßü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡¶õ‡¶∞ ‡¶ó‡ßÅ‡¶®‡ßá ‡¶¨‡¶∏‡ßá ‡¶Ü‡¶õ‡ßá!",
      "‚ù§Ô∏è Crush ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶Æ‡ßÅ‡¶ö‡¶ï‡¶ø ‡¶π‡¶æ‡¶∏‡¶≤‡ßá‡¶á ‡¶¨‡ßÅ‡¶ï‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞ fireworks!",
      "üíØ ‡¶è‡¶∞‡¶æ ‡¶ú‡¶®‡ßç‡¶Æ ‡¶•‡ßá‡¶ï‡ßá‡¶á ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø... ‡¶ú‡¶®‡ßç‡¶Æ ‡¶∏‡¶æ‡¶•‡ßÄ ‡¶ü‡¶æ‡¶á‡¶™!",
      "üéØ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ ‡¶è‡¶Æ‡¶® ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßá, ‡¶™‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶¨‡¶æ‡¶á ‡¶ì‡¶¶‡ßá‡¶∞ '‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá‡¶∞ ‡¶ú‡¶æ‡¶Æ‡¶æ‡¶á-‡¶¨‡¶â' ‡¶Æ‡¶®‡ßá ‡¶ï‡¶∞‡ßá!",
      "üòµ‚Äçüí´ ‡¶è‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá WiFi ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶ì Connect strong!",
      "üî• ‡¶è‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá ‡¶®‡¶æ, ‡¶°‡ßÅ‡¶¨‡ßá ‡¶ó‡ßá‡¶õ‡ßá ‡¶è‡¶ï‡ßá‡¶¨‡¶æ‡¶∞‡ßá Titanic style!"
    ];

    const comment = messages[Math.floor(Math.random() * messages.length)];

    const result = `
‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
     üíñ LOVE METER üíñ
‚îó‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îõ

üíû ${name1} + ${name2}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ù§Ô∏è ‡¶Æ‡¶ø‡¶≤: ${lovePercent}%
[ ${loveBar} ]
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üí¨ ${comment}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
`;

    try {
      if (uid1 && uid2) {
        // ‡¶¶‡ßÅ‡¶á‡¶ú‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶®‡¶¨‡¶ø
        const [img1, img2] = await Promise.all([
          axios.get(`https://graph.facebook.com/${uid1}/picture?width=720&height=720&access_token=${token}`, { responseType: 'arraybuffer' }),
          axios.get(`https://graph.facebook.com/${uid2}/picture?width=720&height=720&access_token=${token}`, { responseType: 'arraybuffer' })
        ]);

        const imgPath1 = path.join(__dirname, 'love_user1.jpg');
        const imgPath2 = path.join(__dirname, 'love_user2.jpg');

        fs.writeFileSync(imgPath1, Buffer.from(img1.data));
        fs.writeFileSync(imgPath2, Buffer.from(img2.data));

        message.reply({
          body: result.trim(),
          attachment: [
            fs.createReadStream(imgPath1),
            fs.createReadStream(imgPath2)
          ]
        }, () => {
          fs.unlinkSync(imgPath1);
          fs.unlinkSync(imgPath2);
        });
      } else {
        // ‡¶Ø‡¶¶‡¶ø ‡¶¶‡ßÅ‡¶á‡¶ú‡¶® ‡¶®‡¶æ ‡¶π‡ßü, ‡¶§‡¶¨‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶¨‡ßá
        message.reply(result.trim());
      }
    } catch (err) {
      console.error(err);
      message.reply("‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶®‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶§‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá‡¶∞ ‡¶ü‡¶æ‡¶® ‡¶†‡¶ø‡¶ï‡¶á ‡¶ú‡¶Æ‡ßá ‡¶Ü‡¶õ‡ßá!");
    }
  }
};
